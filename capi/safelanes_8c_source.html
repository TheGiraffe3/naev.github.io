<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>naev: /home/runner/work/naev.github.io/naev.github.io/staging/src/safelanes.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo32.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">naev
   &#160;<span id="projectnumber">0.9.0-alpha.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">safelanes.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="safelanes_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * See Licensing and Copyright notice in naev.h</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#ifdef HAVE_SUITESPARSE_CHOLMOD_H</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;suitesparse/cholmod.h&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;cholmod.h&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="naev_8h.html">naev.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;safelanes.h&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="array_8h.html">array.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;log.h&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;union_find.h&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * Global parameters.</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> * FIXME: make static as compiler learns to shut up.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a29874299171f0e96c480b139d19adef4">   34</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="safelanes_8c.html#a29874299171f0e96c480b139d19adef4">ALPHA</a>                  = 9;         </div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a8cc38ea9856a355811db270472cbff0e">   35</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="safelanes_8c.html#a8cc38ea9856a355811db270472cbff0e">JUMP_CONDUCTIVITY</a>      = .001;      </div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="safelanes_8c.html#adf0db6b6b5480398f7a38828811a347e">   36</a></span>&#160;<span class="comment">/*static*/</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="safelanes_8c.html#adf0db6b6b5480398f7a38828811a347e">CONVERGENCE_THRESHOLD</a>  = 1e-12;     </div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a3fd1aab8b5b562114c342d2242f955e9">   37</a></span>&#160;<span class="comment">/*static*/</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="safelanes_8c.html#a3fd1aab8b5b562114c342d2242f955e9">MAX_ITERATIONS</a>         = 20;        </div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="safelanes_8c.html#aaadc6fe3d3a89f742b8fea26ad3e0020">   38</a></span>&#160;<span class="comment">/*static*/</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="safelanes_8c.html#aaadc6fe3d3a89f742b8fea26ad3e0020">DISCONNECTED_THRESHOLD</a> = 1e-12;     </div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a17426dcdae8c03c86a1f31d64467cacb">   39</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="safelanes_8c.html#a17426dcdae8c03c86a1f31d64467cacb">MIN_ANGLE</a>              = M_PI/18;   </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">enum</span> {</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a39fca1837c5ce7715cbf571669660c13acd0d908d9c31a4a0a87b61ef8eae116a">   41</a></span>&#160;   <a class="code" href="safelanes_8c.html#a39fca1837c5ce7715cbf571669660c13acd0d908d9c31a4a0a87b61ef8eae116a">STORAGE_MODE_LOWER_TRIANGULAR_PART</a> = -1,             </div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a39fca1837c5ce7715cbf571669660c13ad751e97a20624dcf96e90c9cebf6cde8">   42</a></span>&#160;   <a class="code" href="safelanes_8c.html#a39fca1837c5ce7715cbf571669660c13ad751e97a20624dcf96e90c9cebf6cde8">STORAGE_MODE_UNSYMMETRIC</a> = 0,                        </div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a39fca1837c5ce7715cbf571669660c13a71715610c33a16273628f4dd03b2ddaf">   43</a></span>&#160;   <a class="code" href="safelanes_8c.html#a39fca1837c5ce7715cbf571669660c13a71715610c33a16273628f4dd03b2ddaf">STORAGE_MODE_UPPER_TRIANGULAR_PART</a> = +1,             </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;};</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * Types.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a6c17c947c8b80597417b5e8033ece177">   52</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="safelanes_8c.html#a6c17c947c8b80597417b5e8033ece177">VertexType_</a> {VERTEX_PLANET, VERTEX_JUMP} VertexType;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="structVertex__.html">   55</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structVertex__.html">Vertex_</a> {</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="structVertex__.html#a834399ba7a8ce546073837aef4643abc">   56</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="structVertex__.html#a834399ba7a8ce546073837aef4643abc">system</a>;                  </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="structVertex__.html#a2d1525b8e92dc632a3c0a823e034bcf2">   57</a></span>&#160;   VertexType <a class="code" href="structVertex__.html#a2d1525b8e92dc632a3c0a823e034bcf2">type</a>;             </div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structVertex__.html#a6162d514355c8277d9be330d4a7add8c">   58</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="structVertex__.html#a6162d514355c8277d9be330d4a7add8c">index</a>;                   </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;} Vertex;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="safelanes_8c.html#ad97b022cdb9ed20d3c8d438abb126de7">   62</a></span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="safelanes_8c.html#ad97b022cdb9ed20d3c8d438abb126de7">Edge</a>[2];</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structFaction__.html">Faction_</a> {</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="structFaction__.html#ae5b55052fca12ef1fb4aebbaf2bd32d8">   66</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="structFaction__.html#ae5b55052fca12ef1fb4aebbaf2bd32d8">id</a>;                              </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="structFaction__.html#ada2c5501b9e12cee21e6d0c893c67c62">lane_length_per_presence</a>;     </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;} <a class="code" href="structFaction.html">Faction</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">   71</a></span>&#160;<span class="keyword">typedef</span> uint32_t <a class="code" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"> * Global state.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="safelanes_8c.html#aa58e17c4af561cdaa005b3580c3fa7fb">   77</a></span>&#160;<span class="keyword">static</span> cholmod_common <a class="code" href="safelanes_8c.html#aa58e17c4af561cdaa005b3580c3fa7fb">C</a>;        </div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">   78</a></span>&#160;<span class="keyword">static</span> Vertex *<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>;    </div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">   79</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> *<a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">   80</a></span>&#160;<span class="keyword">static</span> <a class="code" href="safelanes_8c.html#ad97b022cdb9ed20d3c8d438abb126de7">Edge</a> *<a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>;        </div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a3618d6cdf70c52f72b15c81070693f61">   81</a></span>&#160;<span class="keyword">static</span> <a class="code" href="structFaction.html">Faction</a> *<a class="code" href="safelanes_8c.html#a3618d6cdf70c52f72b15c81070693f61">faction_stack</a>;  </div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">   82</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> *<a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a>;       </div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a1222831db8d353d1eb2a90657b13d510">   83</a></span>&#160;<span class="keyword">static</span> <a class="code" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a> *<a class="code" href="safelanes_8c.html#a1222831db8d353d1eb2a90657b13d510">lane_fmask</a>; </div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">   84</a></span>&#160;<span class="keyword">static</span> <a class="code" href="safelanes_8c.html#ad97b022cdb9ed20d3c8d438abb126de7">Edge</a> *<a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>;    </div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="safelanes_8c.html#ad8c56a2bc6659e012deb950a177de980">   85</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> *<a class="code" href="safelanes_8c.html#ad8c56a2bc6659e012deb950a177de980">tmp_edge_conduct</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="safelanes_8c.html#adb9d7e93db98f884a9e714d22294613c">   86</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> *<a class="code" href="safelanes_8c.html#adb9d7e93db98f884a9e714d22294613c">tmp_anchor_vertices</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a7fda430b3001413f448b9958a7751b17">   87</a></span>&#160;<span class="keyword">static</span> cholmod_triplet *<a class="code" href="safelanes_8c.html#a7fda430b3001413f448b9958a7751b17">stiff</a>;  </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"> * Prototypes.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a3c2cc6590abb29f43b76939a27b31e56">safelanes_initStacks</a> (<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a65dd96f6f0cf0797c1fbec19f17a0feb">safelanes_initStacks_edge</a> (<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#aa3ed497a49d3620fb1cb453fa133049c">safelanes_initStacks_faction</a> (<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#ab0a911b9f8f5c90ab849ccc4496a30b3">safelanes_initStacks_vertex</a> (<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a464496adb6ec57165299c15b83820677">safelanes_initStacks_anchor</a> (<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a2f6b5caeff5f82d8e89b3528e3ce016e">safelanes_destroyStacks</a> (<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a1ed8534c125c3bf5d7af5666d859a23d">safelanes_destroyTmp</a> (<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a1b2ff9d83db3703564b4f73ca049a3fa">safelanes_initStiff</a> (<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#abc43b4efb63978abc11fac04fe993ed7">safelanes_destroyStiff</a> (<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="safelanes_8c.html#ae1e9854097df368558c97ab9f1ca029a">safelanes_triangleTooFlat</a>( <span class="keyword">const</span> Vector2d* m, <span class="keyword">const</span> Vector2d* n, <span class="keyword">const</span> Vector2d* p, <span class="keywordtype">double</span> lmn );</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="safelanes_8c.html#a7121c6b95a1dce5c9b1ecb65c78d82e9">vertex_faction</a>( <span class="keywordtype">int</span> i );</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> Vector2d* <a class="code" href="safelanes_8c.html#a55948c6d15e1521da75def96f9101457">vertex_pos</a>( <span class="keywordtype">int</span> i );</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a> <a class="code" href="safelanes_8c.html#a52b22d2ceb0269d94574085cae6c3edd">MASK_ANY_FACTION</a>();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a> <a class="code" href="safelanes_8c.html#ad368c730e63fd59732210c0364ae247f">MASK_ONE_FACTION</a>( <span class="keywordtype">int</span> <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a> <a class="code" href="safelanes_8c.html#a03359fb97d46cc37446a32f10501a0f6">MASK_COMPROMISE</a>( <span class="keywordtype">int</span> id1, <span class="keywordtype">int</span> id2 );</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a11a9dc4d76b5a3e13ce678b9ce171e53">  111</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a11a9dc4d76b5a3e13ce678b9ce171e53">array_push_back_edge</a>( <a class="code" href="safelanes_8c.html#ad97b022cdb9ed20d3c8d438abb126de7">Edge</a> **a, <span class="keywordtype">int</span> v0, <span class="keywordtype">int</span> v1 )</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <span class="keywordtype">int</span> *vs = <a class="code" href="array_8h.html#a8037aba47ab61629eee083791786b582">array_grow</a>( a );</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   vs[0] = v0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   vs[1] = v1;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a4d303e9455704b4d246d8d8f85741202">  121</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a4d303e9455704b4d246d8d8f85741202">safelanes_init</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;{</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   cholmod_start( &amp;<a class="code" href="safelanes_8c.html#aa58e17c4af561cdaa005b3580c3fa7fb">C</a> );</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <a class="code" href="safelanes_8c.html#a9470ea6bf4b3c6bec36363d552de22a8">safelanes_recalculate</a>();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a3350c6b4bd09dd6de9f15506e5f89beb">  131</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a3350c6b4bd09dd6de9f15506e5f89beb">safelanes_destroy</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;{</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <a class="code" href="safelanes_8c.html#abc43b4efb63978abc11fac04fe993ed7">safelanes_destroyStiff</a>();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   <a class="code" href="safelanes_8c.html#a2f6b5caeff5f82d8e89b3528e3ce016e">safelanes_destroyStacks</a>();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   cholmod_finish( &amp;<a class="code" href="safelanes_8c.html#aa58e17c4af561cdaa005b3580c3fa7fb">C</a> );</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a0a3b10e1b87469eb943fd640ee73b3aa">  145</a></span>&#160;SafeLane* <a class="code" href="safelanes_8c.html#a0a3b10e1b87469eb943fd640ee73b3aa">safelanes_get</a> (<span class="keywordtype">int</span> faction, <span class="keyword">const</span> StarSystem* system)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   SafeLane *out, *l;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="keyword">const</span> Vertex *v[2];</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   out = <a class="code" href="array_8h.html#ad1bf30a2043b321afd76277cec9f46c8">array_create</a>( SafeLane );</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <span class="comment">/* FIXME: How slow is this full scan? We could have a sys_to_first_edge stack as well. */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a>); i++) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">for</span> (j=0; j&lt;2; j++)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;         v[j] = &amp;<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>[<a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>[i][j]];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">if</span> (v[0]-&gt;system == system-&gt;id &amp;&amp; <a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a>[i] &gt; 0 &amp;&amp; (faction &lt; 0 || faction == <a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a>[i])) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;         l = &amp;<a class="code" href="array_8h.html#a8037aba47ab61629eee083791786b582">array_grow</a>( &amp;out );</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;         l-&gt;faction = <a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a>[i];</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;         <span class="keywordflow">for</span> (j=0; j&lt;2; j++) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordflow">switch</span> (v[j]-&gt;type) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;               <span class="keywordflow">case</span> VERTEX_PLANET:</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                  l-&gt;point_type[j]   = SAFELANE_LOC_PLANET;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                  l-&gt;point_id[j]     = v[j]-&gt;index;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;               <span class="keywordflow">case</span> VERTEX_JUMP:</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                  l-&gt;point_type[j]   = SAFELANE_LOC_DEST_SYS;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                  l-&gt;point_id[j]     = <a class="code" href="space_8c.html#a94669d7b156a00e769ebef6840fee35f">system_getIndex</a>(v[j]-&gt;system)-&gt;jumps[v[j]-&gt;index].targetid;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;               <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                  ERR( _(<span class="stringliteral">&quot;Invalid vertex type.&quot;</span>) );</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;         }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a9470ea6bf4b3c6bec36363d552de22a8">  183</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a9470ea6bf4b3c6bec36363d552de22a8">safelanes_recalculate</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <a class="code" href="safelanes_8c.html#a3c2cc6590abb29f43b76939a27b31e56">safelanes_initStacks</a>();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <a class="code" href="safelanes_8c.html#a1b2ff9d83db3703564b4f73ca049a3fa">safelanes_initStiff</a>();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <span class="comment">// TODO</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a3c2cc6590abb29f43b76939a27b31e56">  194</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a3c2cc6590abb29f43b76939a27b31e56">safelanes_initStacks</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;{</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <a class="code" href="safelanes_8c.html#a2f6b5caeff5f82d8e89b3528e3ce016e">safelanes_destroyStacks</a>();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   <a class="code" href="safelanes_8c.html#ab0a911b9f8f5c90ab849ccc4496a30b3">safelanes_initStacks_vertex</a>();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <a class="code" href="safelanes_8c.html#aa3ed497a49d3620fb1cb453fa133049c">safelanes_initStacks_faction</a>();</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <a class="code" href="safelanes_8c.html#a65dd96f6f0cf0797c1fbec19f17a0feb">safelanes_initStacks_edge</a>();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <a class="code" href="safelanes_8c.html#a464496adb6ec57165299c15b83820677">safelanes_initStacks_anchor</a>();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   DEBUG( _(<span class="stringliteral">&quot;Built safelanes graph: V=%d, E=%d&quot;</span>), <a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>), <a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>) );</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="safelanes_8c.html#ab0a911b9f8f5c90ab849ccc4496a30b3">  208</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#ab0a911b9f8f5c90ab849ccc4496a30b3">safelanes_initStacks_vertex</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;{</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="keyword">const</span> StarSystem *<a class="code" href="dev__mapedit_8c.html#ab165285133388e9a6369af6d28d4e6c8">systems_stack</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <span class="keyword">const</span> <a class="code" href="structPlanet.html">Planet</a> *p;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   <span class="keyword">const</span> JumpPoint *jp;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   <span class="keywordtype">int</span> system, i, j;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <a class="code" href="dev__mapedit_8c.html#ab165285133388e9a6369af6d28d4e6c8">systems_stack</a> = <a class="code" href="space_8c.html#a162b62a50bd2531e18be082ede90bd64">system_getAll</a>();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a> = <a class="code" href="array_8h.html#ad1bf30a2043b321afd76277cec9f46c8">array_create</a>( Vertex );</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a> = <a class="code" href="array_8h.html#ad1bf30a2043b321afd76277cec9f46c8">array_create</a>( <span class="keywordtype">int</span> );</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <a class="code" href="array_8h.html#ac5806e193ac90a33f8a2a93de4f80dee">array_push_back</a>( &amp;<a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>, 0 );</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a> = <a class="code" href="array_8h.html#ad1bf30a2043b321afd76277cec9f46c8">array_create</a>( <a class="code" href="safelanes_8c.html#ad97b022cdb9ed20d3c8d438abb126de7">Edge</a> );</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <span class="keywordflow">for</span> (system=0; system&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="dev__mapedit_8c.html#ab165285133388e9a6369af6d28d4e6c8">systems_stack</a>); system++) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="dev__mapedit_8c.html#ab165285133388e9a6369af6d28d4e6c8">systems_stack</a>[system].planets); i++) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;         p = <a class="code" href="dev__mapedit_8c.html#ab165285133388e9a6369af6d28d4e6c8">systems_stack</a>[system].planets[i];</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;         <span class="keywordflow">if</span> (p-&gt;real &amp;&amp; p-&gt;presenceAmount) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            Vertex v = {.system = system, .type = VERTEX_PLANET, .index = i};</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <a class="code" href="array_8h.html#ac5806e193ac90a33f8a2a93de4f80dee">array_push_back</a>( &amp;<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>, v );</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;         }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="dev__mapedit_8c.html#ab165285133388e9a6369af6d28d4e6c8">systems_stack</a>[system].jumps); i++) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;         jp = &amp;<a class="code" href="dev__mapedit_8c.html#ab165285133388e9a6369af6d28d4e6c8">systems_stack</a>[system].jumps[i];</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;         <span class="keywordflow">if</span> (!jp_isFlag( jp, JP_HIDDEN|JP_EXITONLY )) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            Vertex v = {.system = system, .type = VERTEX_JUMP, .index = i};</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <a class="code" href="array_8h.html#ac5806e193ac90a33f8a2a93de4f80dee">array_push_back</a>( &amp;<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>, v );</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordflow">if</span> (jp-&gt;targetid &lt; system &amp;&amp; jp-&gt;returnJump != NULL)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;               <span class="keywordflow">for</span> (j = <a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>[jp-&gt;targetid]; j &lt; <a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>[1+jp-&gt;targetid]; j++)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>[j].type == VERTEX_JUMP &amp;&amp; jp-&gt;returnJump == &amp;jp-&gt;target-&gt;jumps[<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>[j].index]) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                     <a class="code" href="safelanes_8c.html#a11a9dc4d76b5a3e13ce678b9ce171e53">array_push_back_edge</a>( &amp;<a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>, j, <a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>)-1 );</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                  }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;         }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <a class="code" href="array_8h.html#ac5806e193ac90a33f8a2a93de4f80dee">array_push_back</a>( &amp;<a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>, <a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>) );</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <a class="code" href="array_8h.html#a95eced54a13af47f83c269654f438b82">array_shrink</a>( &amp;<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a> );</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <a class="code" href="array_8h.html#a95eced54a13af47f83c269654f438b82">array_shrink</a>( &amp;<a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a> );</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a65dd96f6f0cf0797c1fbec19f17a0feb">  253</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a65dd96f6f0cf0797c1fbec19f17a0feb">safelanes_initStacks_edge</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;{</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keyword">const</span> StarSystem *<a class="code" href="dev__mapedit_8c.html#ab165285133388e9a6369af6d28d4e6c8">systems_stack</a>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <span class="keywordtype">int</span> system, i, j, k;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   <a class="code" href="dev__mapedit_8c.html#ab165285133388e9a6369af6d28d4e6c8">systems_stack</a> = <a class="code" href="space_8c.html#a162b62a50bd2531e18be082ede90bd64">system_getAll</a>();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a> = <a class="code" href="array_8h.html#ad1bf30a2043b321afd76277cec9f46c8">array_create</a>( <a class="code" href="safelanes_8c.html#ad97b022cdb9ed20d3c8d438abb126de7">Edge</a> );</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <a class="code" href="safelanes_8c.html#a1222831db8d353d1eb2a90657b13d510">lane_fmask</a> = <a class="code" href="array_8h.html#ad1bf30a2043b321afd76277cec9f46c8">array_create</a>( <a class="code" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a> );</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <a class="code" href="safelanes_8c.html#ad8c56a2bc6659e012deb950a177de980">tmp_edge_conduct</a> = <a class="code" href="array_8h.html#ad1bf30a2043b321afd76277cec9f46c8">array_create</a>( <span class="keywordtype">double</span> );</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   <span class="keywordflow">for</span> (system=0; system&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="dev__mapedit_8c.html#ab165285133388e9a6369af6d28d4e6c8">systems_stack</a>); system++) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">for</span> (i = <a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>[system]; i &lt; <a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>[1+system]; i++) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;         <span class="keyword">const</span> Vector2d *pi = <a class="code" href="safelanes_8c.html#a55948c6d15e1521da75def96f9101457">vertex_pos</a>( i );</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;         <span class="keywordflow">for</span> (j = <a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>[system]; j &lt; i; j++) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keyword">const</span> Vector2d *pj = <a class="code" href="safelanes_8c.html#a55948c6d15e1521da75def96f9101457">vertex_pos</a>( j );</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordtype">double</span> lij = vect_dist( pi, pj );</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordtype">int</span> has_approx_midpoint = 0;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordflow">for</span> (k = <a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>[system]; k &lt; <a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>[1+system]; k++)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;               <span class="keywordflow">if</span> (k!=i &amp;&amp; k!=j &amp;&amp; <a class="code" href="safelanes_8c.html#ae1e9854097df368558c97ab9f1ca029a">safelanes_triangleTooFlat</a>( pi, pj, <a class="code" href="safelanes_8c.html#a55948c6d15e1521da75def96f9101457">vertex_pos</a>( k ), lij )) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                  has_approx_midpoint = 1;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;               }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordflow">if</span> (has_approx_midpoint)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;               <span class="keywordflow">continue</span>;  <span class="comment">/* The edge from i to j is disallowed in favor of a path through k. */</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <a class="code" href="safelanes_8c.html#a11a9dc4d76b5a3e13ce678b9ce171e53">array_push_back_edge</a>( &amp;<a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>, i, j );</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <a class="code" href="array_8h.html#ac5806e193ac90a33f8a2a93de4f80dee">array_push_back</a>( &amp;<a class="code" href="safelanes_8c.html#a1222831db8d353d1eb2a90657b13d510">lane_fmask</a>, <a class="code" href="safelanes_8c.html#a03359fb97d46cc37446a32f10501a0f6">MASK_COMPROMISE</a>( <a class="code" href="safelanes_8c.html#a7121c6b95a1dce5c9b1ecb65c78d82e9">vertex_faction</a>( i ), <a class="code" href="safelanes_8c.html#a7121c6b95a1dce5c9b1ecb65c78d82e9">vertex_faction</a>( j ) ) );</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <a class="code" href="array_8h.html#ac5806e193ac90a33f8a2a93de4f80dee">array_push_back</a>( &amp;<a class="code" href="safelanes_8c.html#ad8c56a2bc6659e012deb950a177de980">tmp_edge_conduct</a>, 1/lij );</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;         }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   <a class="code" href="array_8h.html#a95eced54a13af47f83c269654f438b82">array_shrink</a>( &amp;<a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a> );</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a> = <a class="code" href="array_8h.html#a6f15b617933d8ed080bd53b043342923">array_create_size</a>( <span class="keywordtype">int</span>, <a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>) );</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   memset( <a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a>, 0, <a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a>)*<span class="keyword">sizeof</span>(<a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a>[0]) );</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="safelanes_8c.html#aa3ed497a49d3620fb1cb453fa133049c">  293</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#aa3ed497a49d3620fb1cb453fa133049c">safelanes_initStacks_faction</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <span class="keywordtype">int</span> *faction_all;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   <a class="code" href="safelanes_8c.html#a3618d6cdf70c52f72b15c81070693f61">faction_stack</a> = <a class="code" href="array_8h.html#ad1bf30a2043b321afd76277cec9f46c8">array_create</a>( <a class="code" href="structFaction.html">Faction</a> );</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   faction_all = <a class="code" href="faction_8c.html#ad307fe188136328941ce738cf4547dd6">faction_getAll</a>();</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(faction_all); i++) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <a class="code" href="structFaction.html">Faction</a> f = {.id = i, .lane_length_per_presence = <a class="code" href="faction_8c.html#ada4fd8cdd8072da5785276aa3e6f7908">faction_lane_length_per_presence</a>(i)};</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keywordflow">if</span> (f.lane_length_per_presence &gt; 0.)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;         <a class="code" href="array_8h.html#ac5806e193ac90a33f8a2a93de4f80dee">array_push_back</a>( &amp;<a class="code" href="safelanes_8c.html#a3618d6cdf70c52f72b15c81070693f61">faction_stack</a>, f );</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <a class="code" href="array_8h.html#a04e810cfeccd1cd523f9b28e68aca564">array_free</a>( faction_all );</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <a class="code" href="array_8h.html#a95eced54a13af47f83c269654f438b82">array_shrink</a>( &amp;<a class="code" href="safelanes_8c.html#a3618d6cdf70c52f72b15c81070693f61">faction_stack</a> );</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a464496adb6ec57165299c15b83820677">  312</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a464496adb6ec57165299c15b83820677">safelanes_initStacks_anchor</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   UnionFind uf;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   <span class="keywordtype">int</span> i, nsys, *systems;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   nsys = <a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>) - 1;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <a class="code" href="union__find_8c.html#aa6a3484a2cea96a3449251c1d346b05b">unionfind_init</a>( &amp;uf, nsys );</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>); i++)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <a class="code" href="union__find_8c.html#ab22ddeb0d7403572a1a733871fcf77c1">unionfind_union</a>( &amp;uf, <a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>[<a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>[i][0]].system, <a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>[<a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>[i][1]].system );</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   systems = <a class="code" href="union__find_8c.html#a36ae38452a2444c6cb09593af7ae2b62">unionfind_findall</a>( &amp;uf );</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   <a class="code" href="safelanes_8c.html#adb9d7e93db98f884a9e714d22294613c">tmp_anchor_vertices</a> = <a class="code" href="array_8h.html#a6f15b617933d8ed080bd53b043342923">array_create_size</a>( <span class="keywordtype">int</span>, <a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(systems) );</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   <span class="comment">/* Add an anchor vertex per system, but only if there actually is a vertex in the system. */</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(systems); i++)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>[systems[i]] &lt; <a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>[1+systems[i]]) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;         <a class="code" href="array_8h.html#ac5806e193ac90a33f8a2a93de4f80dee">array_push_back</a>( &amp;<a class="code" href="safelanes_8c.html#adb9d7e93db98f884a9e714d22294613c">tmp_anchor_vertices</a>, <a class="code" href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a>[systems[i]] );</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;         DEBUG( _(<span class="stringliteral">&quot;Anchoring safelanes graph in system: %s.&quot;</span>), <a class="code" href="space_8c.html#a94669d7b156a00e769ebef6840fee35f">system_getIndex</a>(systems[i])-&gt;name );</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <a class="code" href="union__find_8c.html#ac7766e27aff034f3c87885d0db114143">unionfind_free</a>( &amp;uf );</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a2f6b5caeff5f82d8e89b3528e3ce016e">  337</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a2f6b5caeff5f82d8e89b3528e3ce016e">safelanes_destroyStacks</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;{</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <a class="code" href="safelanes_8c.html#a1ed8534c125c3bf5d7af5666d859a23d">safelanes_destroyTmp</a>();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <a class="code" href="array_8h.html#a04e810cfeccd1cd523f9b28e68aca564">array_free</a>( <a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a> );</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a> = NULL;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <a class="code" href="array_8h.html#a04e810cfeccd1cd523f9b28e68aca564">array_free</a>( <a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a> );</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   <a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a> = NULL;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   <a class="code" href="array_8h.html#a04e810cfeccd1cd523f9b28e68aca564">array_free</a>( <a class="code" href="safelanes_8c.html#a3618d6cdf70c52f72b15c81070693f61">faction_stack</a> );</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   <a class="code" href="safelanes_8c.html#a3618d6cdf70c52f72b15c81070693f61">faction_stack</a> = NULL;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <a class="code" href="array_8h.html#a04e810cfeccd1cd523f9b28e68aca564">array_free</a>( <a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a> );</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   <a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a> = NULL;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <a class="code" href="array_8h.html#a04e810cfeccd1cd523f9b28e68aca564">array_free</a>( <a class="code" href="safelanes_8c.html#a1222831db8d353d1eb2a90657b13d510">lane_fmask</a> );</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <a class="code" href="safelanes_8c.html#a1222831db8d353d1eb2a90657b13d510">lane_fmask</a> = NULL;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a1ed8534c125c3bf5d7af5666d859a23d">  356</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a1ed8534c125c3bf5d7af5666d859a23d">safelanes_destroyTmp</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;{</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   <a class="code" href="array_8h.html#a04e810cfeccd1cd523f9b28e68aca564">array_free</a>( <a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a> );</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   <a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a> = NULL;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <a class="code" href="array_8h.html#a04e810cfeccd1cd523f9b28e68aca564">array_free</a>( <a class="code" href="safelanes_8c.html#ad8c56a2bc6659e012deb950a177de980">tmp_edge_conduct</a> );</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <a class="code" href="safelanes_8c.html#ad8c56a2bc6659e012deb950a177de980">tmp_edge_conduct</a> = NULL;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   <a class="code" href="array_8h.html#a04e810cfeccd1cd523f9b28e68aca564">array_free</a>( <a class="code" href="safelanes_8c.html#adb9d7e93db98f884a9e714d22294613c">tmp_anchor_vertices</a> );</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <a class="code" href="safelanes_8c.html#adb9d7e93db98f884a9e714d22294613c">tmp_anchor_vertices</a> = NULL;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <a class="code" href="array_8h.html#a04e810cfeccd1cd523f9b28e68aca564">array_free</a>( <a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a> );</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <a class="code" href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a> = NULL;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a1b2ff9d83db3703564b4f73ca049a3fa">  372</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#a1b2ff9d83db3703564b4f73ca049a3fa">safelanes_initStiff</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;{</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <span class="keywordtype">int</span> n, v, i;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <span class="keywordtype">int</span> *pi, *pj;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   <span class="keywordtype">double</span> *pv;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   <span class="keywordtype">double</span> max_conductivity;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   v = <a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   n = 3*(<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>)+<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>)) + <a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#adb9d7e93db98f884a9e714d22294613c">tmp_anchor_vertices</a>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   <a class="code" href="safelanes_8c.html#a7fda430b3001413f448b9958a7751b17">stiff</a> = cholmod_allocate_triplet( v, v, n, <a class="code" href="safelanes_8c.html#a39fca1837c5ce7715cbf571669660c13a71715610c33a16273628f4dd03b2ddaf">STORAGE_MODE_UPPER_TRIANGULAR_PART</a>, CHOLMOD_REAL, &amp;<a class="code" href="safelanes_8c.html#aa58e17c4af561cdaa005b3580c3fa7fb">C</a> );</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="comment">/* Populate triplets: internal edges (ii ij jj), implicit jump connections (ditto), anchor conditions. */</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   pi = <a class="code" href="safelanes_8c.html#a7fda430b3001413f448b9958a7751b17">stiff</a>-&gt;i; pj = <a class="code" href="safelanes_8c.html#a7fda430b3001413f448b9958a7751b17">stiff</a>-&gt;j; pv = <a class="code" href="safelanes_8c.html#a7fda430b3001413f448b9958a7751b17">stiff</a>-&gt;x;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>); i++) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      *pi++ = <a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>[i][0]; *pj++ = <a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>[i][0]; *pv++ = +<a class="code" href="safelanes_8c.html#ad8c56a2bc6659e012deb950a177de980">tmp_edge_conduct</a>[i];</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      *pi++ = <a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>[i][0]; *pj++ = <a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>[i][1]; *pv++ = -<a class="code" href="safelanes_8c.html#ad8c56a2bc6659e012deb950a177de980">tmp_edge_conduct</a>[i];</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      *pi++ = <a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>[i][1]; *pj++ = <a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>[i][1]; *pv++ = +<a class="code" href="safelanes_8c.html#ad8c56a2bc6659e012deb950a177de980">tmp_edge_conduct</a>[i];</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>); i++) {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      *pi++ = <a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>[i][0]; *pj++ = <a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>[i][0]; *pv++ = +<a class="code" href="safelanes_8c.html#a8cc38ea9856a355811db270472cbff0e">JUMP_CONDUCTIVITY</a>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      *pi++ = <a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>[i][0]; *pj++ = <a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>[i][1]; *pv++ = -<a class="code" href="safelanes_8c.html#a8cc38ea9856a355811db270472cbff0e">JUMP_CONDUCTIVITY</a>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      *pi++ = <a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>[i][1]; *pj++ = <a class="code" href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a>[i][1]; *pv++ = +<a class="code" href="safelanes_8c.html#a8cc38ea9856a355811db270472cbff0e">JUMP_CONDUCTIVITY</a>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <span class="comment">/* Add a Robin boundary condition, using the max conductivity (after activation) for spectral reasons. */</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   max_conductivity = <a class="code" href="safelanes_8c.html#a8cc38ea9856a355811db270472cbff0e">JUMP_CONDUCTIVITY</a>/(<a class="code" href="safelanes_8c.html#a29874299171f0e96c480b139d19adef4">ALPHA</a>+1);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a>); i++)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      max_conductivity = <a class="code" href="naev_8h.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>( max_conductivity, <a class="code" href="safelanes_8c.html#ad8c56a2bc6659e012deb950a177de980">tmp_edge_conduct</a>[i] );</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   max_conductivity = <a class="code" href="naev_8h.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>( <a class="code" href="safelanes_8c.html#a8cc38ea9856a355811db270472cbff0e">JUMP_CONDUCTIVITY</a>, (1+<a class="code" href="safelanes_8c.html#a29874299171f0e96c480b139d19adef4">ALPHA</a>)*max_conductivity ); <span class="comment">/* Activation scales entries by 1+ALPHA later. */</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#adb9d7e93db98f884a9e714d22294613c">tmp_anchor_vertices</a>); i++) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      *pi++ = <a class="code" href="safelanes_8c.html#adb9d7e93db98f884a9e714d22294613c">tmp_anchor_vertices</a>[i]; *pj++ = <a class="code" href="safelanes_8c.html#adb9d7e93db98f884a9e714d22294613c">tmp_anchor_vertices</a>[i]; *pv++ = max_conductivity;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   <a class="code" href="safelanes_8c.html#a1ed8534c125c3bf5d7af5666d859a23d">safelanes_destroyTmp</a>();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;}</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="safelanes_8c.html#abc43b4efb63978abc11fac04fe993ed7">  409</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="safelanes_8c.html#abc43b4efb63978abc11fac04fe993ed7">safelanes_destroyStiff</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;{</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   cholmod_free_triplet( &amp;<a class="code" href="safelanes_8c.html#a7fda430b3001413f448b9958a7751b17">stiff</a>, &amp;<a class="code" href="safelanes_8c.html#aa58e17c4af561cdaa005b3580c3fa7fb">C</a> );</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="safelanes_8c.html#ae1e9854097df368558c97ab9f1ca029a">  418</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="safelanes_8c.html#ae1e9854097df368558c97ab9f1ca029a">safelanes_triangleTooFlat</a>( <span class="keyword">const</span> Vector2d* m, <span class="keyword">const</span> Vector2d* n, <span class="keyword">const</span> Vector2d* p, <span class="keywordtype">double</span> lmn )</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;{</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> MAX_COSINE = cos(<a class="code" href="safelanes_8c.html#a17426dcdae8c03c86a1f31d64467cacb">MIN_ANGLE</a>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <span class="keywordtype">double</span> lnp = vect_dist( n, p );</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <span class="keywordtype">double</span> lmp = vect_dist( m, p );</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="keywordtype">double</span> dpn = ((n-&gt;x-m-&gt;x)*(n-&gt;x-p-&gt;x) + (n-&gt;y-m-&gt;y)*(n-&gt;y-p-&gt;y)) / ( lmn * lnp );</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <span class="keywordtype">double</span> dpm = ((m-&gt;x-n-&gt;x)*(m-&gt;x-p-&gt;x) + (m-&gt;y-n-&gt;y)*(m-&gt;y-p-&gt;y)) / ( lmn * lmp );</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <span class="keywordflow">return</span> (dpn &gt; MAX_COSINE &amp;&amp; lnp &lt; lmn) || (dpm &gt; MAX_COSINE &amp;&amp; lmp &lt; lmn);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a7121c6b95a1dce5c9b1ecb65c78d82e9">  432</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="safelanes_8c.html#a7121c6b95a1dce5c9b1ecb65c78d82e9">vertex_faction</a>( <span class="keywordtype">int</span> i )</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;{</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   <span class="keyword">const</span> StarSystem *sys = <a class="code" href="space_8c.html#a94669d7b156a00e769ebef6840fee35f">system_getIndex</a>(<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>[i].system);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>[i].type) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">case</span> VERTEX_PLANET:</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;         <span class="keywordflow">return</span> sys-&gt;planets[<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>[i].index]-&gt;faction;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">case</span> VERTEX_JUMP:</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;         <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;         ERR( _(<span class="stringliteral">&quot;Invalid vertex type.&quot;</span>) );</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a55948c6d15e1521da75def96f9101457">  449</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> Vector2d* <a class="code" href="safelanes_8c.html#a55948c6d15e1521da75def96f9101457">vertex_pos</a>( <span class="keywordtype">int</span> i )</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;{</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <span class="keyword">const</span> StarSystem *sys = <a class="code" href="space_8c.html#a94669d7b156a00e769ebef6840fee35f">system_getIndex</a>(<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>[i].system);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>[i].type) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">case</span> VERTEX_PLANET:</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;         <span class="keywordflow">return</span> &amp;sys-&gt;planets[<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>[i].index]-&gt;pos;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordflow">case</span> VERTEX_JUMP:</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;         <span class="keywordflow">return</span> &amp;sys-&gt;jumps[<a class="code" href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a>[i].index].pos;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         ERR( _(<span class="stringliteral">&quot;Invalid vertex type.&quot;</span>) );</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;}</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a52b22d2ceb0269d94574085cae6c3edd">  464</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a> <a class="code" href="safelanes_8c.html#a52b22d2ceb0269d94574085cae6c3edd">MASK_ANY_FACTION</a>()</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;{</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   <span class="keywordflow">return</span> ~(<a class="code" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a>)0;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="safelanes_8c.html#ad368c730e63fd59732210c0364ae247f">  470</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a> <a class="code" href="safelanes_8c.html#ad368c730e63fd59732210c0364ae247f">MASK_ONE_FACTION</a>( <span class="keywordtype">int</span> <span class="keywordtype">id</span> )</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;{</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a>(<a class="code" href="safelanes_8c.html#a3618d6cdf70c52f72b15c81070693f61">faction_stack</a>) &amp;&amp; <a class="code" href="safelanes_8c.html#a3618d6cdf70c52f72b15c81070693f61">faction_stack</a>[i].id &lt;= id; i++)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="safelanes_8c.html#a3618d6cdf70c52f72b15c81070693f61">faction_stack</a>[i].<span class="keywordtype">id</span> == <span class="keywordtype">id</span>)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;         <span class="keywordflow">return</span> ((<a class="code" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a>)1)&lt;&lt;i;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="safelanes_8c.html#a52b22d2ceb0269d94574085cae6c3edd">MASK_ANY_FACTION</a>();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;}</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno"><a class="line" href="safelanes_8c.html#a03359fb97d46cc37446a32f10501a0f6">  479</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a> <a class="code" href="safelanes_8c.html#a03359fb97d46cc37446a32f10501a0f6">MASK_COMPROMISE</a>( <span class="keywordtype">int</span> id1, <span class="keywordtype">int</span> id2 )</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;{</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   <a class="code" href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a> m1 = <a class="code" href="safelanes_8c.html#ad368c730e63fd59732210c0364ae247f">MASK_ONE_FACTION</a>(id1), m2 = <a class="code" href="safelanes_8c.html#ad368c730e63fd59732210c0364ae247f">MASK_ONE_FACTION</a>(id2);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   <span class="keywordflow">return</span> (m1 &amp; m2) ? (m1 &amp; m2) : (m1 | m2);  <span class="comment">/* Any/Any -&gt; any, Any/f -&gt; just f, f1/f2 -&gt; either. */</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="afaction_8c_html_ad307fe188136328941ce738cf4547dd6"><div class="ttname"><a href="faction_8c.html#ad307fe188136328941ce738cf4547dd6">faction_getAll</a></div><div class="ttdeci">int * faction_getAll()</div><div class="ttdoc">Returns all faction IDs in an array (array.h).</div><div class="ttdef"><b>Definition:</b> <a href="faction_8c_source.html#l00164">faction.c:164</a></div></div>
<div class="ttc" id="asafelanes_8c_html_adf0db6b6b5480398f7a38828811a347e"><div class="ttname"><a href="safelanes_8c.html#adf0db6b6b5480398f7a38828811a347e">CONVERGENCE_THRESHOLD</a></div><div class="ttdeci">const double CONVERGENCE_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00036">safelanes.c:36</a></div></div>
<div class="ttc" id="astructVertex___html_a6162d514355c8277d9be330d4a7add8c"><div class="ttname"><a href="structVertex__.html#a6162d514355c8277d9be330d4a7add8c">Vertex_::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00058">safelanes.c:58</a></div></div>
<div class="ttc" id="aunion__find_8c_html_a36ae38452a2444c6cb09593af7ae2b62"><div class="ttname"><a href="union__find_8c.html#a36ae38452a2444c6cb09593af7ae2b62">unionfind_findall</a></div><div class="ttdeci">int * unionfind_findall(UnionFind *uf)</div><div class="ttdoc">Returns a designated representative of each subset in an array (array.h).</div><div class="ttdef"><b>Definition:</b> <a href="union__find_8c_source.html#l00061">union_find.c:61</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a1222831db8d353d1eb2a90657b13d510"><div class="ttname"><a href="safelanes_8c.html#a1222831db8d353d1eb2a90657b13d510">lane_fmask</a></div><div class="ttdeci">static FactionMask * lane_fmask</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00083">safelanes.c:83</a></div></div>
<div class="ttc" id="astructPlanet_html"><div class="ttname"><a href="structPlanet.html">Planet</a></div><div class="ttdoc">Represents a planet.</div></div>
<div class="ttc" id="astructFaction___html_ada2c5501b9e12cee21e6d0c893c67c62"><div class="ttname"><a href="structFaction__.html#ada2c5501b9e12cee21e6d0c893c67c62">Faction_::lane_length_per_presence</a></div><div class="ttdeci">double lane_length_per_presence</div><div class="ttdef"><b>Definition:</b> <a href="faction_8c_source.html#l00080">faction.c:80</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a2f6b5caeff5f82d8e89b3528e3ce016e"><div class="ttname"><a href="safelanes_8c.html#a2f6b5caeff5f82d8e89b3528e3ce016e">safelanes_destroyStacks</a></div><div class="ttdeci">static void safelanes_destroyStacks(void)</div><div class="ttdoc">Tears down the local faction/object stacks.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00337">safelanes.c:337</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a3c2cc6590abb29f43b76939a27b31e56"><div class="ttname"><a href="safelanes_8c.html#a3c2cc6590abb29f43b76939a27b31e56">safelanes_initStacks</a></div><div class="ttdeci">static void safelanes_initStacks(void)</div><div class="ttdoc">Sets up the local faction/object stacks.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00194">safelanes.c:194</a></div></div>
<div class="ttc" id="astructVertex___html_a2d1525b8e92dc632a3c0a823e034bcf2"><div class="ttname"><a href="structVertex__.html#a2d1525b8e92dc632a3c0a823e034bcf2">Vertex_::type</a></div><div class="ttdeci">VertexType type</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00057">safelanes.c:57</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a11a9dc4d76b5a3e13ce678b9ce171e53"><div class="ttname"><a href="safelanes_8c.html#a11a9dc4d76b5a3e13ce678b9ce171e53">array_push_back_edge</a></div><div class="ttdeci">static void array_push_back_edge(Edge **a, int v0, int v1)</div><div class="ttdoc">Like array_push_back( a, Edge{v0, v1} ), but achievable in C. :-P.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00111">safelanes.c:111</a></div></div>
<div class="ttc" id="astructFaction_html"><div class="ttname"><a href="structFaction.html">Faction</a></div><div class="ttdoc">Represents a faction.</div></div>
<div class="ttc" id="asafelanes_8c_html_a3618d6cdf70c52f72b15c81070693f61"><div class="ttname"><a href="safelanes_8c.html#a3618d6cdf70c52f72b15c81070693f61">faction_stack</a></div><div class="ttdeci">static Faction * faction_stack</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00081">safelanes.c:81</a></div></div>
<div class="ttc" id="astructVertex___html_a834399ba7a8ce546073837aef4643abc"><div class="ttname"><a href="structVertex__.html#a834399ba7a8ce546073837aef4643abc">Vertex_::system</a></div><div class="ttdeci">int system</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00056">safelanes.c:56</a></div></div>
<div class="ttc" id="aspace_8c_html_a94669d7b156a00e769ebef6840fee35f"><div class="ttname"><a href="space_8c.html#a94669d7b156a00e769ebef6840fee35f">system_getIndex</a></div><div class="ttdeci">StarSystem * system_getIndex(int id)</div><div class="ttdoc">Get the system by its index.</div><div class="ttdef"><b>Definition:</b> <a href="space_8c_source.html#l00884">space.c:884</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a464496adb6ec57165299c15b83820677"><div class="ttname"><a href="safelanes_8c.html#a464496adb6ec57165299c15b83820677">safelanes_initStacks_anchor</a></div><div class="ttdeci">static void safelanes_initStacks_anchor(void)</div><div class="ttdoc">Sets up the local stacks with entry per faction.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00312">safelanes.c:312</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a03359fb97d46cc37446a32f10501a0f6"><div class="ttname"><a href="safelanes_8c.html#a03359fb97d46cc37446a32f10501a0f6">MASK_COMPROMISE</a></div><div class="ttdeci">static FactionMask MASK_COMPROMISE(int id1, int id2)</div><div class="ttdoc">A mask with appropriate lane-building rights given one faction ID owning each endpoint.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00479">safelanes.c:479</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a55948c6d15e1521da75def96f9101457"><div class="ttname"><a href="safelanes_8c.html#a55948c6d15e1521da75def96f9101457">vertex_pos</a></div><div class="ttdeci">static const Vector2d * vertex_pos(int i)</div><div class="ttdoc">Return the vertex's coordinates within its system (by reference since our vec2's are fat).</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00449">safelanes.c:449</a></div></div>
<div class="ttc" id="astructFaction___html"><div class="ttname"><a href="structFaction__.html">Faction_</a></div><div class="ttdoc">Description of a lane-building faction.</div><div class="ttdef"><b>Definition:</b> <a href="faction_8c_source.html#l00055">faction.c:55</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a52b22d2ceb0269d94574085cae6c3edd"><div class="ttname"><a href="safelanes_8c.html#a52b22d2ceb0269d94574085cae6c3edd">MASK_ANY_FACTION</a></div><div class="ttdeci">static FactionMask MASK_ANY_FACTION()</div><div class="ttdoc">Return a mask matching any faction.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00464">safelanes.c:464</a></div></div>
<div class="ttc" id="asafelanes_8c_html_ae1e9854097df368558c97ab9f1ca029a"><div class="ttname"><a href="safelanes_8c.html#ae1e9854097df368558c97ab9f1ca029a">safelanes_triangleTooFlat</a></div><div class="ttdeci">static int safelanes_triangleTooFlat(const Vector2d *m, const Vector2d *n, const Vector2d *p, double lmn)</div><div class="ttdoc">Return true if this triangle is so flat that lanes from point m to point n aren't allowed.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00418">safelanes.c:418</a></div></div>
<div class="ttc" id="aunion__find_8c_html_aa6a3484a2cea96a3449251c1d346b05b"><div class="ttname"><a href="union__find_8c.html#aa6a3484a2cea96a3449251c1d346b05b">unionfind_init</a></div><div class="ttdeci">void unionfind_init(UnionFind *uf, int n)</div><div class="ttdoc">Creates a UnionFind structure on {0, ..., n}.</div><div class="ttdef"><b>Definition:</b> <a href="union__find_8c_source.html#l00017">union_find.c:17</a></div></div>
<div class="ttc" id="aarray_8h_html_ac5806e193ac90a33f8a2a93de4f80dee"><div class="ttname"><a href="array_8h.html#ac5806e193ac90a33f8a2a93de4f80dee">array_push_back</a></div><div class="ttdeci">#define array_push_back(ptr_array, element)</div><div class="ttdoc">Adds a new element at the end of the array.</div><div class="ttdef"><b>Definition:</b> <a href="array_8h_source.html#l00133">array.h:133</a></div></div>
<div class="ttc" id="aarray_8h_html"><div class="ttname"><a href="array_8h.html">array.h</a></div><div class="ttdoc">Provides macros to work with dynamic arrays.</div></div>
<div class="ttc" id="asafelanes_8c_html_a17426dcdae8c03c86a1f31d64467cacb"><div class="ttname"><a href="safelanes_8c.html#a17426dcdae8c03c86a1f31d64467cacb">MIN_ANGLE</a></div><div class="ttdeci">static const double MIN_ANGLE</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00039">safelanes.c:39</a></div></div>
<div class="ttc" id="aunion__find_8c_html_ac7766e27aff034f3c87885d0db114143"><div class="ttname"><a href="union__find_8c.html#ac7766e27aff034f3c87885d0db114143">unionfind_free</a></div><div class="ttdeci">void unionfind_free(UnionFind *uf)</div><div class="ttdoc">Frees resources associated with uf.</div><div class="ttdef"><b>Definition:</b> <a href="union__find_8c_source.html#l00029">union_find.c:29</a></div></div>
<div class="ttc" id="asafelanes_8c_html_aeb56157a718390625ff976595c343b2c"><div class="ttname"><a href="safelanes_8c.html#aeb56157a718390625ff976595c343b2c">tmp_jump_edges</a></div><div class="ttdeci">static Edge * tmp_jump_edges</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00084">safelanes.c:84</a></div></div>
<div class="ttc" id="afaction_8c_html_ada4fd8cdd8072da5785276aa3e6f7908"><div class="ttname"><a href="faction_8c.html#ada4fd8cdd8072da5785276aa3e6f7908">faction_lane_length_per_presence</a></div><div class="ttdeci">double faction_lane_length_per_presence(int f)</div><div class="ttdoc">Gets the faction's weight for patrolled safe-lane construction (0 means they don't build lanes).</div><div class="ttdef"><b>Definition:</b> <a href="faction_8c_source.html#l00345">faction.c:345</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a8cc38ea9856a355811db270472cbff0e"><div class="ttname"><a href="safelanes_8c.html#a8cc38ea9856a355811db270472cbff0e">JUMP_CONDUCTIVITY</a></div><div class="ttdeci">static const double JUMP_CONDUCTIVITY</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00035">safelanes.c:35</a></div></div>
<div class="ttc" id="asafelanes_8c_html_adb9d7e93db98f884a9e714d22294613c"><div class="ttname"><a href="safelanes_8c.html#adb9d7e93db98f884a9e714d22294613c">tmp_anchor_vertices</a></div><div class="ttdeci">static int * tmp_anchor_vertices</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00086">safelanes.c:86</a></div></div>
<div class="ttc" id="adev__mapedit_8c_html_ab165285133388e9a6369af6d28d4e6c8"><div class="ttname"><a href="dev__mapedit_8c.html#ab165285133388e9a6369af6d28d4e6c8">systems_stack</a></div><div class="ttdeci">StarSystem * systems_stack</div><div class="ttdef"><b>Definition:</b> <a href="space_8c_source.html#l00086">space.c:86</a></div></div>
<div class="ttc" id="aarray_8h_html_ad1bf30a2043b321afd76277cec9f46c8"><div class="ttname"><a href="array_8h.html#ad1bf30a2043b321afd76277cec9f46c8">array_create</a></div><div class="ttdeci">#define array_create(basic_type)</div><div class="ttdoc">Creates a new dynamic array of ‘basic_type’.</div><div class="ttdef"><b>Definition:</b> <a href="array_8h_source.html#l00097">array.h:97</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a65dd96f6f0cf0797c1fbec19f17a0feb"><div class="ttname"><a href="safelanes_8c.html#a65dd96f6f0cf0797c1fbec19f17a0feb">safelanes_initStacks_edge</a></div><div class="ttdeci">static void safelanes_initStacks_edge(void)</div><div class="ttdoc">Sets up the local stacks with entry per edge. Faction stack must be set up.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00253">safelanes.c:253</a></div></div>
<div class="ttc" id="aarray_8h_html_a6f15b617933d8ed080bd53b043342923"><div class="ttname"><a href="array_8h.html#a6f15b617933d8ed080bd53b043342923">array_create_size</a></div><div class="ttdeci">#define array_create_size(basic_type, capacity)</div><div class="ttdoc">Creates a new dynamic array of ‘basic_type’ with an initial capacity.</div><div class="ttdef"><b>Definition:</b> <a href="array_8h_source.html#l00106">array.h:106</a></div></div>
<div class="ttc" id="asafelanes_8c_html_abc43b4efb63978abc11fac04fe993ed7"><div class="ttname"><a href="safelanes_8c.html#abc43b4efb63978abc11fac04fe993ed7">safelanes_destroyStiff</a></div><div class="ttdeci">static void safelanes_destroyStiff(void)</div><div class="ttdoc">Tears down the stiffness matrix.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00409">safelanes.c:409</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a897a858e85050613d24587e98ff52f79"><div class="ttname"><a href="safelanes_8c.html#a897a858e85050613d24587e98ff52f79">lane_faction</a></div><div class="ttdeci">static int * lane_faction</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00082">safelanes.c:82</a></div></div>
<div class="ttc" id="asafelanes_8c_html_ad97b022cdb9ed20d3c8d438abb126de7"><div class="ttname"><a href="safelanes_8c.html#ad97b022cdb9ed20d3c8d438abb126de7">Edge</a></div><div class="ttdeci">int Edge[2]</div><div class="ttdoc">An edge is a pair of vertex indices.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00062">safelanes.c:62</a></div></div>
<div class="ttc" id="aarray_8h_html_a8037aba47ab61629eee083791786b582"><div class="ttname"><a href="array_8h.html#a8037aba47ab61629eee083791786b582">array_grow</a></div><div class="ttdeci">#define array_grow(ptr_array)</div><div class="ttdoc">Increases the number of elements by one and returns the last element.</div><div class="ttdef"><b>Definition:</b> <a href="array_8h_source.html#l00123">array.h:123</a></div></div>
<div class="ttc" id="aspace_8c_html_a162b62a50bd2531e18be082ede90bd64"><div class="ttname"><a href="space_8c.html#a162b62a50bd2531e18be082ede90bd64">system_getAll</a></div><div class="ttdeci">StarSystem * system_getAll(void)</div><div class="ttdoc">Gets an array (array.h) of all star systems.</div><div class="ttdef"><b>Definition:</b> <a href="space_8c_source.html#l00801">space.c:801</a></div></div>
<div class="ttc" id="astructVertex___html"><div class="ttname"><a href="structVertex__.html">Vertex_</a></div><div class="ttdoc">Reference to a planet or jump point.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00055">safelanes.c:55</a></div></div>
<div class="ttc" id="asafelanes_8c_html_aa58e17c4af561cdaa005b3580c3fa7fb"><div class="ttname"><a href="safelanes_8c.html#aa58e17c4af561cdaa005b3580c3fa7fb">C</a></div><div class="ttdeci">static cholmod_common C</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00077">safelanes.c:77</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a0a3b10e1b87469eb943fd640ee73b3aa"><div class="ttname"><a href="safelanes_8c.html#a0a3b10e1b87469eb943fd640ee73b3aa">safelanes_get</a></div><div class="ttdeci">SafeLane * safelanes_get(int faction, const StarSystem *system)</div><div class="ttdoc">Shuts down the safelanes system.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00145">safelanes.c:145</a></div></div>
<div class="ttc" id="anaev_8h_html_aacc3ee1a7f283f8ef65cea31f4436a95"><div class="ttname"><a href="naev_8h.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a></div><div class="ttdeci">#define MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="naev_8h_source.html#l00045">naev.h:45</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a6c17c947c8b80597417b5e8033ece177"><div class="ttname"><a href="safelanes_8c.html#a6c17c947c8b80597417b5e8033ece177">VertexType_</a></div><div class="ttdeci">VertexType_</div><div class="ttdoc">Object type: like SafeLaneLocType, but with Naev stack indexing in mind.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00052">safelanes.c:52</a></div></div>
<div class="ttc" id="asafelanes_8c_html_acfcc8382d9c7a863c26328a26ef4ffc0"><div class="ttname"><a href="safelanes_8c.html#acfcc8382d9c7a863c26328a26ef4ffc0">sys_to_first_vertex</a></div><div class="ttdeci">static int * sys_to_first_vertex</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00079">safelanes.c:79</a></div></div>
<div class="ttc" id="asafelanes_8c_html_aaadc6fe3d3a89f742b8fea26ad3e0020"><div class="ttname"><a href="safelanes_8c.html#aaadc6fe3d3a89f742b8fea26ad3e0020">DISCONNECTED_THRESHOLD</a></div><div class="ttdeci">const double DISCONNECTED_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00038">safelanes.c:38</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a39fca1837c5ce7715cbf571669660c13a71715610c33a16273628f4dd03b2ddaf"><div class="ttname"><a href="safelanes_8c.html#a39fca1837c5ce7715cbf571669660c13a71715610c33a16273628f4dd03b2ddaf">STORAGE_MODE_UPPER_TRIANGULAR_PART</a></div><div class="ttdeci">@ STORAGE_MODE_UPPER_TRIANGULAR_PART</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00043">safelanes.c:43</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a9470ea6bf4b3c6bec36363d552de22a8"><div class="ttname"><a href="safelanes_8c.html#a9470ea6bf4b3c6bec36363d552de22a8">safelanes_recalculate</a></div><div class="ttdeci">void safelanes_recalculate(void)</div><div class="ttdoc">Update the safe lane locations in response to the universe changing (e.g., diff applied).</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00183">safelanes.c:183</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a3350c6b4bd09dd6de9f15506e5f89beb"><div class="ttname"><a href="safelanes_8c.html#a3350c6b4bd09dd6de9f15506e5f89beb">safelanes_destroy</a></div><div class="ttdeci">void safelanes_destroy(void)</div><div class="ttdoc">Shuts down the safelanes system.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00131">safelanes.c:131</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a1ed8534c125c3bf5d7af5666d859a23d"><div class="ttname"><a href="safelanes_8c.html#a1ed8534c125c3bf5d7af5666d859a23d">safelanes_destroyTmp</a></div><div class="ttdeci">static void safelanes_destroyTmp(void)</div><div class="ttdoc">Tears down the local faction/object stacks.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00356">safelanes.c:356</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a4d303e9455704b4d246d8d8f85741202"><div class="ttname"><a href="safelanes_8c.html#a4d303e9455704b4d246d8d8f85741202">safelanes_init</a></div><div class="ttdeci">void safelanes_init(void)</div><div class="ttdoc">Initializes the safelanes system.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00121">safelanes.c:121</a></div></div>
<div class="ttc" id="anaev_8h_html"><div class="ttname"><a href="naev_8h.html">naev.h</a></div><div class="ttdoc">Header file with generic functions and naev-specifics.</div></div>
<div class="ttc" id="aarray_8h_html_a95eced54a13af47f83c269654f438b82"><div class="ttname"><a href="array_8h.html#a95eced54a13af47f83c269654f438b82">array_shrink</a></div><div class="ttdeci">#define array_shrink(ptr_array)</div><div class="ttdoc">Shrinks memory to fit only ‘size’ elements.</div><div class="ttdef"><b>Definition:</b> <a href="array_8h_source.html#l00153">array.h:153</a></div></div>
<div class="ttc" id="asafelanes_8c_html_adc4f638884850868990e6671d4c59d96"><div class="ttname"><a href="safelanes_8c.html#adc4f638884850868990e6671d4c59d96">vertex_stack</a></div><div class="ttdeci">static Vertex * vertex_stack</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00078">safelanes.c:78</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a1b2ff9d83db3703564b4f73ca049a3fa"><div class="ttname"><a href="safelanes_8c.html#a1b2ff9d83db3703564b4f73ca049a3fa">safelanes_initStiff</a></div><div class="ttdeci">static void safelanes_initStiff(void)</div><div class="ttdoc">Sets up the stiffness matrix.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00372">safelanes.c:372</a></div></div>
<div class="ttc" id="asafelanes_8c_html_ad8c56a2bc6659e012deb950a177de980"><div class="ttname"><a href="safelanes_8c.html#ad8c56a2bc6659e012deb950a177de980">tmp_edge_conduct</a></div><div class="ttdeci">static double * tmp_edge_conduct</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00085">safelanes.c:85</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a29874299171f0e96c480b139d19adef4"><div class="ttname"><a href="safelanes_8c.html#a29874299171f0e96c480b139d19adef4">ALPHA</a></div><div class="ttdeci">static const double ALPHA</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00034">safelanes.c:34</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a87107ac1f804d94f8e38afe692fc8e53"><div class="ttname"><a href="safelanes_8c.html#a87107ac1f804d94f8e38afe692fc8e53">FactionMask</a></div><div class="ttdeci">uint32_t FactionMask</div><div class="ttdoc">A bet that we'll never willingly point this algorithm at 32 factions.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00071">safelanes.c:71</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a39fca1837c5ce7715cbf571669660c13acd0d908d9c31a4a0a87b61ef8eae116a"><div class="ttname"><a href="safelanes_8c.html#a39fca1837c5ce7715cbf571669660c13acd0d908d9c31a4a0a87b61ef8eae116a">STORAGE_MODE_LOWER_TRIANGULAR_PART</a></div><div class="ttdeci">@ STORAGE_MODE_LOWER_TRIANGULAR_PART</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00041">safelanes.c:41</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a39fca1837c5ce7715cbf571669660c13ad751e97a20624dcf96e90c9cebf6cde8"><div class="ttname"><a href="safelanes_8c.html#a39fca1837c5ce7715cbf571669660c13ad751e97a20624dcf96e90c9cebf6cde8">STORAGE_MODE_UNSYMMETRIC</a></div><div class="ttdeci">@ STORAGE_MODE_UNSYMMETRIC</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00042">safelanes.c:42</a></div></div>
<div class="ttc" id="aunion__find_8c_html_ab22ddeb0d7403572a1a733871fcf77c1"><div class="ttname"><a href="union__find_8c.html#ab22ddeb0d7403572a1a733871fcf77c1">unionfind_union</a></div><div class="ttdeci">void unionfind_union(UnionFind *uf, int x, int y)</div><div class="ttdoc">Declares x and y to be in the same subset.</div><div class="ttdef"><b>Definition:</b> <a href="union__find_8c_source.html#l00037">union_find.c:37</a></div></div>
<div class="ttc" id="aarray_8h_html_a04e810cfeccd1cd523f9b28e68aca564"><div class="ttname"><a href="array_8h.html#a04e810cfeccd1cd523f9b28e68aca564">array_free</a></div><div class="ttdeci">#define array_free(ptr_array)</div><div class="ttdoc">Frees memory allocated and sets array to NULL.</div><div class="ttdef"><b>Definition:</b> <a href="array_8h_source.html#l00162">array.h:162</a></div></div>
<div class="ttc" id="asafelanes_8c_html_ab0a911b9f8f5c90ab849ccc4496a30b3"><div class="ttname"><a href="safelanes_8c.html#ab0a911b9f8f5c90ab849ccc4496a30b3">safelanes_initStacks_vertex</a></div><div class="ttdeci">static void safelanes_initStacks_vertex(void)</div><div class="ttdoc">Sets up the local stacks with entry per vertex (or per jump).</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00208">safelanes.c:208</a></div></div>
<div class="ttc" id="asafelanes_8c_html_ad368c730e63fd59732210c0364ae247f"><div class="ttname"><a href="safelanes_8c.html#ad368c730e63fd59732210c0364ae247f">MASK_ONE_FACTION</a></div><div class="ttdeci">static FactionMask MASK_ONE_FACTION(int id)</div><div class="ttdoc">A mask giving this faction (NOT faction_stack index) exclusive rights to build, if it's a lane-buildi...</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00470">safelanes.c:470</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a3fd1aab8b5b562114c342d2242f955e9"><div class="ttname"><a href="safelanes_8c.html#a3fd1aab8b5b562114c342d2242f955e9">MAX_ITERATIONS</a></div><div class="ttdeci">const double MAX_ITERATIONS</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00037">safelanes.c:37</a></div></div>
<div class="ttc" id="aarray_8h_html_a7c62b40a0c0e00e204db23aee2186d70"><div class="ttname"><a href="array_8h.html#a7c62b40a0c0e00e204db23aee2186d70">array_size</a></div><div class="ttdeci">static ALWAYS_INLINE int array_size(const void *array)</div><div class="ttdoc">Returns number of elements in the array.</div><div class="ttdef"><b>Definition:</b> <a href="array_8h_source.html#l00172">array.h:172</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a7121c6b95a1dce5c9b1ecb65c78d82e9"><div class="ttname"><a href="safelanes_8c.html#a7121c6b95a1dce5c9b1ecb65c78d82e9">vertex_faction</a></div><div class="ttdeci">static int vertex_faction(int i)</div><div class="ttdoc">Return the vertex's owning faction (ID, not faction_stack index), or -1 if not applicable.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00432">safelanes.c:432</a></div></div>
<div class="ttc" id="asafelanes_8c_html_aa3ed497a49d3620fb1cb453fa133049c"><div class="ttname"><a href="safelanes_8c.html#aa3ed497a49d3620fb1cb453fa133049c">safelanes_initStacks_faction</a></div><div class="ttdeci">static void safelanes_initStacks_faction(void)</div><div class="ttdoc">Sets up the local stacks with entry per faction.</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00293">safelanes.c:293</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a7fda430b3001413f448b9958a7751b17"><div class="ttname"><a href="safelanes_8c.html#a7fda430b3001413f448b9958a7751b17">stiff</a></div><div class="ttdeci">static cholmod_triplet * stiff</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00087">safelanes.c:87</a></div></div>
<div class="ttc" id="asafelanes_8c_html_a39fd88db24a147f9d871f4aac542965a"><div class="ttname"><a href="safelanes_8c.html#a39fd88db24a147f9d871f4aac542965a">edge_stack</a></div><div class="ttdeci">static Edge * edge_stack</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00080">safelanes.c:80</a></div></div>
<div class="ttc" id="astructFaction___html_ae5b55052fca12ef1fb4aebbaf2bd32d8"><div class="ttname"><a href="structFaction__.html#ae5b55052fca12ef1fb4aebbaf2bd32d8">Faction_::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="safelanes_8c_source.html#l00066">safelanes.c:66</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
